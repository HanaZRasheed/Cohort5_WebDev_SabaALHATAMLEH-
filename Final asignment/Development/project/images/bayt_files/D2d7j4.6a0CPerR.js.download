(this.$WP=this.$WP||[]).push(["D2d7j4",(e,t)=>{"use strict";var s,o,a,i,n,r,l,h,d,c,p,u,v,S,w,M,g,k,m,f,L,C,I,O,B,E,A,H=e=>s("div",{className:"fhKBhZM1"},s("span",{className:"_1nMvKfvS"},s(f,{name:"map-pin-fill"})),s("span",{className:"_3LYct7zg"},e.locationName),s("span",{className:"_2qQ7gwlz",onClick:e.onClose},s(f,{name:"times"}))),P=()=>window&&window.location&&"#MAPVIEW"===window.location.hash;return[()=>{C=class extends o{constructor(e){super(e),this.onMapLoaded=e=>{this.setState({mapInterface:e.map,lastSearchBBox:e.map.getBounds()})},this.onLocationHoverStart=e=>{"DESKTOP"===this.props.viewportCategory&&this.setState(()=>({hoveredMarker:e}))},this.onLocationHoverEnd=e=>{this.setState(t=>t.hoveredMarker&&t.hoveredMarker.id===e.id?{hoveredMarker:null}:null)},this.onPinSelected=e=>{if(e){var t=this.props.detailLocation===e?"primary_pin":"selected_marker";this.state.visitedLocations[e.id]=!0,this.setState({selectedMarker:e,hoveredMarker:null,carouselState:t})}else this.setState({selectedMarker:null,hoveredMarker:null,carouselState:"hidden"})},this.onMapClick=()=>{this.setState({selectedMarker:null,hoveredMarker:null,carouselState:"hidden"})},this.onRedoSearch=()=>{var{mapInterface:e}=this.state;if(e){var t=e.getBounds();this.setState({lastSearchBBox:t})}},this.toggleAlsoShowOption=(e,t)=>{var s=Object.assign({},this.state.selectedAlsoShowOptions);s[e]=!0,this.setState({selectedAlsoShowOptions:s}),t&&this.onRedoSearch()},this.clearAlsoShowOptions=()=>{var{carouselState:e}=this.state;"selected_marker"===e&&(e="hidden"),this.setState({selectedAlsoShowOptions:{},carouselState:e})},this.state={mapInterface:null,hoveredMarker:null,selectedMarker:"MOBILE"===e.viewportCategory?e.detailLocation:null,carouselState:"MOBILE"===e.viewportCategory?"selected_marker":"hidden",hasFitResults:!1,selectedAlsoShowOptions:{[d.hotels]:!1,[d.restaurants]:!0,[d.thingsToDo]:!1},visitedLocations:{},lastSearchBBox:null}}componentDidUpdate(){if(!this.state.hasFitResults){var{mapInterface:e}=this.state;e&&this.setState({hasFitResults:!0})}}render(){var{detailLocation:e,onClose:t}=this.props,{selectedMarker:o,hoveredMarker:a,selectedAlsoShowOptions:i,visitedLocations:n,hasFitResults:r}=this.state,f=a?a.id:0,L=o?o.id:0,C="DESKTOP"===this.props.viewportCategory,I="MOBILE"===this.props.viewportCategory,O=Object.keys(i).filter(e=>i[e]).length>0,B=null;"hidden"!==this.state.carouselState&&o&&(B=[o]);var E=I&&B&&B.length;return s("div",{className:"_1PGnWhDg"},s(H,{locationName:e.name,onClose:t}),s(h,{initialCenter:new l(e.geoPoint.latitude,e.geoPoint.longitude),initialZoom:15,onLoad:this.onMapLoaded,onClick:this.onMapClick},s(w,{blacklist:{[e.id]:!0},showSelectedMarker:I,selectedMarker:L,hoveredMarker:f,boundingBox:this.state.lastSearchBBox,isVisited:n,showRestaurants:i[d.restaurants],showAttractions:i[d.thingsToDo],showHotels:i[d.hotels],onMarkerMouseEnter:this.onLocationHoverStart,onMarkerMouseLeave:this.onLocationHoverEnd,onMarkerClick:this.onPinSelected}),s("div",{className:"_223atK7v "+(E?"_2z2K7EdI":"")},s(M,null)),s(m,{locations:[e],hoveredMarker:f,selectedMarker:L,visited:{},showSelectedMarker:I,onMouseEnter:this.onLocationHoverStart,onMouseLeave:this.onLocationHoverEnd,onClick:this.onPinSelected}),s("div",{className:"BGhsvUZJ"}),C&&!!a&&a!==o&&s(k,{location:a}),!I&&o&&s(g,{location:o,autoPan:!0}),E&&s(v,{locations:B||[],selectedMarker:L,onSwipe:()=>{}}),s("div",{className:"_3J3R2qTf"},s(p,null)),O&&r&&s("div",{className:"XojAfeXR"},s(I?u:S,{onRedoSearch:this.onRedoSearch})),s("div",{className:"_2LMkaGwS "+(E?"_2z2K7EdI":"")},s(c,{options:[d.hotels,d.restaurants,d.thingsToDo],selectedValues:this.state.selectedAlsoShowOptions,onValueChange:this.toggleAlsoShowOption,onClearOptions:this.clearAlsoShowOptions}))))}},E=i((e,t)=>Object.assign({},t,{viewportCategory:e.meta.device.viewportCategory}))(C),I=class extends o{render(){var e="/data/1.0/mapsEnrichment/restaurant/"+this.props.locationId;return s(L,{url:e},({loading:e,data:t,error:o})=>s(a,null,this.props.children({loading:e,location:t,error:o})))}},O=class extends o{render(){return s(a,null,s(I,{locationId:this.props.locationId},({location:e})=>e?s("div",{style:{width:"100%",height:"100%"}},s(E,{detailLocation:e,onClose:this.props.onClose})):null))}},B=class extends o{constructor(...e){super(...e),this.state={showMap:!1},this.hasPushedHash=!1,this.mapRadio=new n("restaurant-detail-map"),this.openMap=()=>{history.pushState(null,document.title,"#MAPVIEW"),this.hasPushedHash=!0,this.checkHash()},this.checkHash=()=>{var e=P();this.setState({showMap:e})},this.closeMap=()=>{this.hasPushedHash?(window.history.back(),this.checkHash()):((()=>{var e=window.location.toString();if(e.indexOf("#")>0){var t=e.substring(0,e.indexOf("#"));window.history.replaceState(null,document.title,t)}})(),this.checkHash())}}componentDidMount(){this.mapRadio.on("open-trigger-clicked",this.openMap),this.mapRadio.on("close-trigger-clicked",this.closeMap),this.setState({showMap:P()}),window.addEventListener("popstate",this.checkHash),window.addEventListener("hashchange",this.checkHash,!1)}componentWillUnmount(){window.removeEventListener("popstate",this.checkHash),window.removeEventListener("hashchange",this.checkHash),this.mapRadio.off("open-trigger-clicked",this.openMap)}render(){return s(a,null,this.state.showMap&&s(r,{onClose:this.closeMap},s(O,{onClose:this.closeMap,locationId:this.props.locationId,geoId:this.props.geoId})))}},A=i(e=>({locationId:e.page.detailId,geoId:e.page.geoId}))(B),e("default",A)},[e=>(s=e.createElement,o=e.PureComponent,a=e.Fragment),e=>i=e.connect,e=>n=e.default,e=>r=e.default,e=>l=e.LatLng,e=>h=e.default,e=>(d=e.AlsoShowValues,c=e.AlsoShowControl),e=>p=e.default,e=>u=e.default,e=>v=e.default,e=>S=e.RedoSearchButton,e=>w=e.default,e=>M=e.default,e=>g=e.default,e=>k=e.default,e=>m=e.AnchorMarkers,e=>f=e.Icon,e=>L=e.default]]},["cDcdfi","h74DsO","l6BSGt","A7p4Ig","VwUieX","UaLTva","R57Q-B","KB4cfU","ue1PHu","l7q5Ts","R4dv1u","7XASeK","wbt5GG","IdKzX3","uWGJsK","Xolfce","_qQcW3","w_dosq"]]);
